import{b as L,E as _,G as K}from"./index-giYzRquH.js";function Q(e,t){var n=!1;return function(...r){n||(e.call(null,...r),n=!0,setTimeout(function(){n=!1},t))}}function H(e){return e.split(" ").filter(t=>t)}var Z=typeof window<"u";function v(e,t,n=!1){if(!t)return;const r=H(t);if(r.length&&!r.includes("longTouch"))for(const o of e){if(!T(o)||!h.has(o)){o.classList.add(...r);continue}const i=[],l=h.get(o);if(l){for(const s of r)o.classList.contains(s)?o.classList.contains(s)&&n===!1&&i.push(s):o.classList.add(s);l.privateClasses=i,h.set(o,l)}}}function x(e,t){if(!t)return;const n=H(t);if(n.length)for(const r of e){if(!T(r)){r.classList.remove(...n);continue}const o=h.get(r);if(o)for(const i of n)o.privateClasses.includes(i)||r.classList.remove(i)}}function A(e){let t=e.parentNode;for(;t!==null&&t.nodeType===1&&t instanceof HTMLElement;){const r=window.getComputedStyle(t).getPropertyValue("overflow");if(r==="scroll"||r==="auto")return t;t=t.parentNode}return document.documentElement}function ee(e){if(!(e.e instanceof TouchEvent))return;const t=e.e.touches[0].clientX,n=e.e.touches[0].clientY;let r=document.elementFromPoint(t,n);if(!T(r))return;let o,i=!0;for(;r&&i;){if(h.has(r)||f.has(r)){i=!1,o=f.has(r);break}r=r.parentNode}if(o){const l=f.get(r);return l?{parent:{el:r,data:l}}:void 0}else{const l=h.get(r);if(!l)return;const s=f.get(r.parentNode);return s?{node:{el:r,data:l},parent:{el:r.parentNode,data:s}}:void 0}}function T(e){return e instanceof HTMLElement&&e.parentNode instanceof HTMLElement}function F(e,t){const n=new AbortController;for(const r in t){const o=t[r];e.addEventListener(r,o,{signal:n.signal,passive:!1})}return n}function B(e,t,n=!1){const r=window.getComputedStyle(e),o=["position","z-index","top","left","x","pointer-events","y","transform-origin","filter","-webkit-text-fill-color"];for(const i of Array.from(r))n===!1&&i&&o.includes(i)||t.style.setProperty(i,r.getPropertyValue(i),r.getPropertyPriority(i));for(const i of Array.from(e.children)){if(!T(i))continue;const l=t.children[Array.from(e.children).indexOf(i)];B(i,l,n)}}function m(e){return e instanceof DragEvent?{x:e.clientX,y:e.clientY}:{x:e.touches[0].clientX,y:e.touches[0].clientY}}Array();var I=[{transform:"translateY(100%)"},{transform:"translateY(0)"}],k=[{transform:"translateY(-100%)"},{transform:"translateY(0)"}],b=[{transform:"translateX(100%)"},{transform:"translateX(0)"}],C=[{transform:"translateX(-100%)"},{transform:"translateX(0)"}];function je(e={}){return t=>{const n=f.get(t);if(n)return{setup(){n.config.remapFinished=()=>{},document.head.querySelector("[data-drag-and-drop]")},setupNodeRemap(r){if(!a)return;const o=e.duration||150;if(r.nodeData.value===a.draggedNode.data.value){switch(a.incomingDirection){case"below":p(r.node,I,o);break;case"above":p(r.node,k,o);break;case"left":p(r.node,C,o);break;case"right":p(r.node,b,o);break}return}if(!a.affectedNodes.map(u=>u.data.value).includes(r.nodeData.value))return;const i=r.node.getBoundingClientRect(),l=a.affectedNodes.findIndex(u=>u.data.value===r.nodeData.value),c=a.draggedNode.data.index>=a.targetIndex;let d;if(c?d=a.affectedNodes[l+1]?a.affectedNodes[l+1]:a.affectedNodes[l-1]:d=a.affectedNodes[l-1]?a.affectedNodes[l-1]:a.affectedNodes[l+1],d){const u=Math.abs(i.x-d.el.getBoundingClientRect().x),D=Math.abs(i.y-d.el.getBoundingClientRect().y);u>D&&c?p(r.node,C,o):u>D&&!c&&p(r.node,b,o)}else switch(a.incomingDirection){case"below":p(r.node,k,o);break;case"above":p(r.node,I,o);break;case"left":p(r.node,b,o);break;case"right":p(r.node,C,o);break}}}}}function p(e,t,n){a&&(a.preventEnter=!0,e.animate(t,{duration:n}),setTimeout(()=>{a&&(a.swappedNodeValue=void 0,a.remapJustFinished=!0,a.lastTargetValue=void 0,a.preventEnter=!1)},n))}var M={up:[0,-1],down:[0,1],left:[-1,0],right:[1,0]},h=new WeakMap,f=new WeakMap,a=void 0;function te(){a=void 0}function S(e){return a={ascendingDirection:!1,incomingDirection:void 0,enterCount:0,targetIndex:0,affectedNodes:[],lastValue:void 0,activeNode:void 0,lastTargetValue:void 0,remapJustFinished:!1,preventEnter:!1,clonedDraggedEls:[],swappedNodeValue:!1,originalZIndex:void 0,...e},a}function ne(e,t){return a={...e,...t},a}function X(e){const{x:t,y:n}=m(e.e);return{coordinates:{x:t,y:n},draggedNode:{el:e.targetData.node.el,data:e.targetData.node.data},draggedNodes:[{el:e.targetData.node.el,data:e.targetData.node.data}],initialIndex:e.targetData.node.data.index,initialParent:{el:e.targetData.parent.el,data:e.targetData.parent.data},lastParent:{el:e.targetData.parent.el,data:e.targetData.parent.data},scrollParent:A(e.targetData.node.el)}}function re(e,t){const n=Y(e),o=[...w(t.targetData.parent.el,t.targetData.parent.data).filter(i=>!n.includes(i))];o.splice(t.targetData.node.data.index,0,...n),e.lastTargetValue=t.targetData.node.data.value,E(t.targetData.parent.el,t.targetData.parent.data,[...o])}function w(e,t){return[...t.getValues(e)]}function E(e,t,n){t.setValues(n,e)}function Y(e){return[...e.draggedNodes.map(t=>t.data.value)]}function oe({parent:e,getValues:t,setValues:n,config:r={}}){var i,l;if(!Z)return;document.addEventListener("dragover",s=>{if(s.preventDefault(),a){a.remapJustFinished=!1,a.lastTargetValue=void 0;const{x:c,y:d}=m(s);a.coordinates.y=d,a.coordinates.x=c,y()}}),W(e);const o={getValues:t,setValues:n,config:{handleDragstart:se,handleDragoverNode:Re,handleDragoverParent:He,handleEnd:me,handleTouchstart:Te,handleTouchmove:be,handleTouchOverNode:ge,handleTouchOverParent:Ze,performSort:re,performTransfer:Se,root:document,setupNode:pe,setupNodeRemap:J,reapplyDragClasses:he,tearDownNode:ve,tearDownNodeRemap:De,remapFinished:le,scrollBehavior:{x:.8,y:.8},threshold:{horizontal:0,vertical:0},...r},enabledNodes:[],abortControllers:{}};ae(e,o),(i=r.plugins)==null||i.forEach(s=>{var c,d;(d=(c=s(e))==null?void 0:c.tearDown)==null||d.call(c)}),(l=r.plugins)==null||l.forEach(s=>{var c,d;(d=(c=s(e))==null?void 0:c.setup)==null||d.call(c)}),z(e,!0)}function W(e){const t=f.get(e);t&&t.abortControllers.mainParent&&t.abortControllers.mainParent.abort()}function ae(e,t){new MutationObserver(ie).observe(e,{childList:!0}),f.set(e,t),t.abortControllers.mainParent=F(e,{dragover:Xe(Q(t.config.handleDragoverParent,10)),touchOverParent:t.config.handleTouchOverParent})}function ie(e){const t=e[0].target;t instanceof HTMLElement&&z(t)}function z(e,t){const n=f.get(e);if(!n)return;const r=[],o=n.config;for(let s=0;s<e.children.length;s++){const c=e.children[s];if(!T(c))continue;const d=h.get(c);(t||!d)&&o.tearDownNode({node:c,parent:e,nodeData:d,parentData:n}),!o.disabled&&(!o.draggable||o.draggable&&o.draggable(c))&&r.push(c)}if(r.length!==n.getValues(e).length&&!o.disabled){console.warn("The number of enabled nodes does not match the number of values.");return}const i=n.getValues(e),l=[];for(let s=0;s<r.length;s++){const c=r[s],d=h.get(c),u=Object.assign(d??{privateClasses:[],abortControllers:{}},{value:i[s],index:s});if(a&&u.value===a.draggedNode.data.value&&(a.draggedNode.data=u,a.draggedNode.el=c),a&&a.draggedNodes.map(g=>g.data.value).includes(u.value)){const g=a.draggedNodes.find(G=>G.data.value===u.value);g&&(g.el=c)}l.push({el:c,data:u});const D={node:c,parent:e,parentData:n,nodeData:u};(t||!d)&&o.setupNode(D),J(D)}f.set(e,{...n,enabledNodes:l}),o.remapFinished(n)}function le(){a&&(a.preventEnter=!1,a.swappedNodeValue=void 0,a.remapJustFinished=!0)}function se(e){e.e instanceof DragEvent&&fe({e:e.e,targetData:e.targetData})}function ce(e,t,n){v([e],t),setTimeout(()=>{x([e],t),v([e],n)})}function de(e){const t=S(X(e));return e.e.stopPropagation(),e.e.dataTransfer&&(e.e.dataTransfer.dropEffect="move",e.e.dataTransfer.effectAllowed="move",e.e.dataTransfer.setDragImage(e.targetData.node.el,e.e.offsetX,e.e.offsetY)),t}function $(e){if(!(e.e instanceof DragEvent)&&!(e.e instanceof TouchEvent))return!1;const t=e.targetData.parent.data.config;if(!t.dragHandle)return!0;const n=e.targetData.node.el.querySelectorAll(t.dragHandle);if(!n)return!1;const r=m(e.e),o=t.root.elementFromPoint(r.x,r.y);if(!o)return!1;for(const i of Array.from(n))if(o===i||i.contains(o))return!0;return!1}function ue(e){if(!$(e))return;const t=xe(e);ye(e,t),Pe(e,t)}function fe(e){if(!$(e)){e.e.preventDefault();return}const t=e.targetData.parent.data.config,n=de(e),r=e.targetData.node.el.style.zIndex;n.originalZIndex=r,e.targetData.node.el.style.zIndex="9999",ce(n.draggedNode.el,t.draggingClass,t.dropZoneClass)}function ge(e){a&&(e.detail.targetData.parent.el===a.lastParent.el?q(e.detail,a):P(e.detail,a))}function pe(e){var n;const t=e.parentData.config;e.node.draggable=!0,e.nodeData.abortControllers.mainNode=F(e.node,{dragstart:N(t.handleDragstart),dragover:N(t.handleDragoverNode),dragend:N(t.handleEnd),touchstart:N(t.handleTouchstart),touchmove:N(t.handleTouchmove),touchend:N(t.handleEnd),touchOverNode:t.handleTouchOverNode}),t.reapplyDragClasses(e.node,e.parentData),(n=e.parentData.config.plugins)==null||n.forEach(r=>{var o,i;(i=(o=r(e.parent))==null?void 0:o.setupNode)==null||i.call(o,e)})}function J(e){var t;h.set(e.node,e.nodeData),(t=e.parentData.config.plugins)==null||t.forEach(n=>{var r,o;(o=(r=n(e.parent))==null?void 0:r.setupNodeRemap)==null||o.call(r,e)})}function he(e,t){if(!a)return;const n="touchedNode"in a?t.config.touchDropZoneClass:t.config.dropZoneClass;a.draggedNode.el===e&&v([e],n,!0)}function De(e){var t;(t=e.parentData.config.plugins)==null||t.forEach(n=>{var r,o;(o=(r=n(e.parent))==null?void 0:r.tearDownNodeRemap)==null||o.call(r,e)})}function ve(e){var t,n,r,o,i;(t=e.parentData.config.plugins)==null||t.forEach(l=>{var s,c;(c=(s=l(e.parent))==null?void 0:s.tearDownNode)==null||c.call(s,e)}),e.node.draggable=!1,(r=(n=e.nodeData)==null?void 0:n.abortControllers)!=null&&r.mainNode&&((i=(o=e.nodeData)==null?void 0:o.abortControllers)==null||i.mainNode.abort())}function me(e){a&&(Ne(e,a),te())}function Ne(e,t){var i,l,s,c;document.removeEventListener("contextmenu",j),"longTouchTimeout"in t&&t.longTouchTimeout&&clearTimeout(t.longTouchTimeout);const n=(i=f.get(t.initialParent.el))==null?void 0:i.config,o="touchedNode"in t?n==null?void 0:n.touchDropZoneClass:n==null?void 0:n.dropZoneClass;t.originalZIndex!==void 0&&(t.draggedNode.el.style.zIndex=t.originalZIndex),v(t.draggedNodes.map(d=>d.el),o,!0),x(t.draggedNodes.map(d=>d.el),o),n!=null&&n.longTouchClass&&x(t.draggedNodes.map(d=>d.el),(s=(l=t.initialParent.data)==null?void 0:l.config)==null?void 0:s.longTouchClass),"touchedNode"in t&&((c=t.touchedNode)==null||c.remove())}function Te(e){e.e instanceof TouchEvent&&ue({e:e.e,targetData:e.targetData})}function xe(e){e.e.stopPropagation();const t=e.targetData.node.el.cloneNode(!0),n=e.targetData.node.el.getBoundingClientRect();return ne(S(X(e)),{coordinates:{x:e.e.touches[0].clientX,y:e.e.touches[0].clientY},scrollParent:A(e.targetData.node.el),touchStartLeft:e.e.touches[0].clientX-n.left,touchStartTop:e.e.touches[0].clientY-n.top,touchedNode:t,touchMoving:!1})}function j(e){e.preventDefault()}function ye(e,t){t.touchedNodeDisplay=t.touchedNode.style.display;const n=e.targetData.node.el.getBoundingClientRect();t.touchedNode.style.cssText=`
            width: ${n.width}px;
            position: fixed;
            pointer-events: none;
            top: -9999px;
            z-index: 999999;
            display: none;
          `,document.body.append(t.touchedNode),B(e.targetData.node.el,t.touchedNode),t.touchedNode.style.display="none",document.addEventListener("contextmenu",j)}function Pe(e,t){const n=e.targetData.parent.data.config;n.longTouch&&(t.longTouchTimeout=setTimeout(()=>{t&&(t.longTouch=!0,n.longTouchClass&&e.e.cancelable&&v(t.draggedNodes.map(r=>r.el),n.longTouchClass),e.e.preventDefault())},n.longTouchTimeout||200))}function be(e){!a||!("touchedNode"in a)||Oe(e,a)}function Ce(e,t){t.longTouchClass&&x(e.draggedNodes.map(n=>n.el),t==null?void 0:t.longTouchClass),t.touchDraggingClass&&v([e.touchedNode],t.touchDraggingClass),t.touchDropZoneClass&&v(e.draggedNodes.map(n=>n.el),t.touchDropZoneClass)}function we(e){if(!e||!e.scrollParent)return;const{x:t,y:n,width:r,height:o}=e.scrollParent.getBoundingClientRect(),{x:i,y:l,scrollOutside:s}=e.lastParent.data.config.scrollBehavior;return{state:e,xThresh:i,yThresh:l,scrollOutside:s,scrollParent:e.scrollParent,x:t,y:n,width:r,height:o}}function Ee(e){const t=we(a);if(t)switch(e){case"down":return ke(t.state,t);case"up":return Ie(t.state,t);case"right":return Ve(t.state,t);case"left":return Le(t.state,t)}}function Ve(e,t){const n=t.scrollParent.clientWidth+t.x-e.coordinates.x;if(!(!t.scrollOutside&&n<0)&&n<(1-t.xThresh)*t.scrollParent.clientWidth&&!(t.scrollParent.scrollLeft+t.scrollParent.clientWidth>=t.scrollParent.scrollWidth))return e}function Le(e,t){const n=t.scrollParent.clientWidth+t.x-e.coordinates.x;if(!(!t.scrollOutside&&n>t.scrollParent.clientWidth)&&n>t.xThresh*t.scrollParent.clientWidth&&t.scrollParent.scrollLeft!==0)return e}function Ie(e,t){const n=t.scrollParent.clientHeight+t.y-e.coordinates.y;if(!(!t.scrollOutside&&n>t.scrollParent.clientHeight)&&n>t.yThresh*t.scrollParent.clientHeight&&t.scrollParent.scrollTop!==0)return e}function ke(e,t){const n=t.scrollParent.clientHeight+t.y-e.coordinates.y;if(!(!t.scrollOutside&&n<0)&&n<(1-t.yThresh)*t.scrollParent.clientHeight&&!(t.scrollParent.scrollTop+t.scrollParent.clientHeight>=t.scrollParent.scrollHeight))return e}function Me(e,t){t.touchMoving=!0,t.touchedNode.style.display=t.touchedNodeDisplay||"";const{x:n,y:r}=m(e.e);t.coordinates.y=r,t.coordinates.x=n;const o=t.touchStartLeft??0,i=t.touchStartTop??0;t.touchedNode.style.left=`${n-o}px`,t.touchedNode.style.top=`${r-i}px`,Ce(t,e.targetData.parent.data.config)}function Oe(e,t){if(e.targetData.parent.data.config.longTouch&&!t.longTouch){clearTimeout(t.longTouchTimeout);return}e.e.cancelable&&e.e.preventDefault(),Me(e,t),y();const r=ee(e);if(!r)return;const o={e:e.e,targetData:r};"node"in r?r.node.el.dispatchEvent(new CustomEvent("touchOverNode",{detail:o})):r.parent.el.dispatchEvent(new CustomEvent("touchOverParent",{detail:o}))}function y(){for(const e of Object.keys(M)){const[t,n]=M[e];U(e,t,n)}}function U(e,t,n){const r=Ee(e);r&&(r.scrollParent.scrollBy(t,n),setTimeout(()=>{U(e,t,n)},"touchedNode"in r?10:100))}function Re(e){if(!a)return;const{x:t,y:n}=m(e.e);a.coordinates.y=n,a.coordinates.x=t,y(),Fe(e,a)}function He(e){if(!a)return;const{x:t,y:n}=m(e.e);a.coordinates.y=n,a.coordinates.x=t,y(),P(e,a)}function Ze(e){a&&P(e.detail,a)}function Ae(e,t){if(e.targetData.parent.el===t.lastParent.el)return!1;const n=e.targetData.parent.data.config;if(n.dropZone===!1)return!1;const r=t.initialParent.data.config;return n.accepts?n.accepts(e.targetData.parent,t.initialParent,t.lastParent,t):!(!n.group||n.group!==r.group)}function Fe(e,t){var n;e.e.preventDefault(),e.e.stopPropagation(),e.targetData.parent.el===((n=t.lastParent)==null?void 0:n.el)?q(e,t):P(e,t)}function Be(e,t,n,r){var D;if(t.remapJustFinished)return t.remapJustFinished=!1,t.lastTargetValue=e.targetData.node.data.value,!1;if(t.lastTargetValue===e.targetData.node.data.value||t.draggedNodes.map(g=>g.el).includes(e.targetData.node.el)||t.preventEnter||t.swappedNodeValue===e.targetData.node.data.value||e.targetData.parent.el!==((D=t.lastParent)==null?void 0:D.el)||e.targetData.parent.data.config.sortable===!1)return!1;const o=e.targetData.node.el.getBoundingClientRect(),i=t.draggedNode.el.getBoundingClientRect(),l=o.y-i.y,s=o.x-i.x;let c;const d=t.draggedNode.data.index>e.targetData.node.data.index?[e.targetData.node.data.index,t.draggedNode.data.index]:[t.draggedNode.data.index,e.targetData.node.data.index];t.targetIndex=e.targetData.node.data.index,t.affectedNodes=e.targetData.parent.data.enabledNodes.filter(g=>d[0]<=g.data.index&&g.data.index<=d[1]&&g.el!==t.draggedNode.el),Math.abs(l)>Math.abs(s)?c=l>0?"above":"below":c=s>0?"left":"right";const u=t.lastParent.data.config.threshold;switch(c){case"left":if(n>o.x+o.width*u.horizontal)return t.incomingDirection="left",!0;break;case"right":if(n<o.x+o.width*(1-u.horizontal))return t.incomingDirection="right",!0;break;case"above":if(r>o.y+o.height*u.vertical)return t.incomingDirection="above",!0;break;case"below":if(r<o.y+o.height*(1-u.vertical))return t.incomingDirection="below",!0;break}return!1}function q(e,t){const{x:n,y:r}=m(e.e);Be(e,t,n,r)&&(t.swappedNodeValue=e.targetData.node.data.value,t.preventEnter=!0,e.targetData.parent.data.config.performSort(t,e))}function N(e){function t(n){var l;const r=h.get(n),o=n.parentNode||((l=a==null?void 0:a.lastParent)==null?void 0:l.el);if(!r)return;const i=f.get(o);if(i)return{node:{el:n,data:r},parent:{el:o,data:i}}}return n=>{const r=t(n.currentTarget);if(r)return e({e:n,targetData:r})}}function Se(e,t){const n=Y(e),r=w(e.lastParent.el,e.lastParent.data).filter(s=>!n.includes(s)),o=w(t.targetData.parent.el,t.targetData.parent.data),i=e.initialParent.el===t.targetData.parent.el&&t.targetData.parent.data.config.sortable===!1;let l;"node"in t.targetData?(i?l=e.initialIndex:t.targetData.parent.data.config.sortable===!1?l=t.targetData.parent.data.enabledNodes.length:l=t.targetData.node.data.index,o.splice(l,0,...n)):(l=i?e.initialIndex:t.targetData.parent.data.enabledNodes.length,o.splice(l,0,...n)),E(e.lastParent.el,e.lastParent.data,r),E(t.targetData.parent.el,t.targetData.parent.data,o)}function P(e,t){Ae(e,t)&&(e.targetData.parent.data.config.performTransfer(t,e),t.lastParent=e.targetData.parent)}function Xe(e){function t(n){const r=f.get(n);if(r)return{parent:{el:n,data:r}}}return n=>{const r=t(n.currentTarget);if(r)return e({e:n,targetData:r})}}function O(e){if(e instanceof HTMLElement)return e;if(e.value instanceof HTMLElement)return e.value;if("$el"in e&&e.$el instanceof HTMLElement)return e.$el}function Ye(e,t){Array.isArray(e)||(e=[e]);for(const n of e){const r=O(n);if(r)return t(r);const o=K(n,i=>{if(!i)return;const l=O(i);l?t(l):console.warn("Invalid parent element",i),o()})}}var V=new WeakMap;function We(e){const t=V.get(e);return t?t.value:(console.warn("No values found for parent element"),[])}function ze(e,t){const n=V.get(t);n&&(n.value=e)}function R(e){Z&&(Array.isArray(e)||(e=[e]),e.forEach(t=>{const{parent:n,values:r,...o}=t;Ye(n,$e(o,r))}))}function Ue(e,t={}){const n=L(),r=L(e);function o(i={}){R({parent:n,values:r,...i})}return R({parent:n,values:r,...t}),_(()=>n.value&&W(n.value)),[n,r,o]}function $e(e,t){return n=>{V.set(n,t),oe({parent:n,getValues:We,setValues:ze,config:{...e,dropZones:[]}})}}export{je as a,Ue as u};
